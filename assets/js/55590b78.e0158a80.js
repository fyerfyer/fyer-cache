"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[432],{6666:(e,d,i)=>{i.r(d),i.d(d,{assets:()=>s,contentTitle:()=>h,default:()=>j,frontMatter:()=>t,metadata:()=>r,toc:()=>l});const r=JSON.parse('{"id":"api-reference/config-option","title":"Config Options","description":"\u672c\u6587\u6863\u8be6\u7ec6\u4ecb\u7ecd\u4e86 FyerCache \u4e2d\u6240\u6709\u53ef\u7528\u7684\u914d\u7f6e\u9009\u9879\uff0c\u6309\u7ec4\u4ef6\u7c7b\u522b\u8fdb\u884c\u7ec4\u7ec7\u3002","source":"@site/docs/api-reference/config-option.md","sourceDirName":"api-reference","slug":"/api-reference/config-option","permalink":"/fyer-cache/docs/api-reference/config-option","draft":false,"unlisted":false,"editUrl":"https://github.com/fyerfyer/fyer-rpc/tree/main/docs/api-reference/config-option.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Cluster-Management API","permalink":"/fyer-cache/docs/api-reference/cluster-api"},"next":{"title":"HTTP API","permalink":"/fyer-cache/docs/api-reference/http-api"}}');var n=i(4848),c=i(8453);const t={},h="Config Options",s={},l=[{value:"\u5185\u5b58\u7f13\u5b58\u9009\u9879",id:"\u5185\u5b58\u7f13\u5b58\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u5185\u5b58\u7f13\u5b58",id:"\u793a\u4f8b\u521b\u5efa\u5185\u5b58\u7f13\u5b58",level:3},{value:"\u6e05\u7406\u5668\u9009\u9879",id:"\u6e05\u7406\u5668\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u6e05\u7406\u5668",id:"\u793a\u4f8b\u521b\u5efa\u6e05\u7406\u5668",level:3},{value:"\u5206\u7247\u7f13\u5b58\u9009\u9879",id:"\u5206\u7247\u7f13\u5b58\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u5206\u7247\u7f13\u5b58",id:"\u793a\u4f8b\u521b\u5efa\u5206\u7247\u7f13\u5b58",level:3},{value:"\u96c6\u7fa4\u8282\u70b9\u9009\u9879",id:"\u96c6\u7fa4\u8282\u70b9\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u96c6\u7fa4\u8282\u70b9",id:"\u793a\u4f8b\u521b\u5efa\u96c6\u7fa4\u8282\u70b9",level:3},{value:"\u5206\u5e03\u5f0f\u7f13\u5b58\u9009\u9879",id:"\u5206\u5e03\u5f0f\u7f13\u5b58\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u914d\u7f6e\u5206\u5e03\u5f0f\u7f13\u5b58",id:"\u793a\u4f8b\u914d\u7f6e\u5206\u5e03\u5f0f\u7f13\u5b58",level:3},{value:"\u8fdc\u7a0b\u7f13\u5b58\u9009\u9879",id:"\u8fdc\u7a0b\u7f13\u5b58\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u8fdc\u7a0b\u7f13\u5b58\u5ba2\u6237\u7aef",id:"\u793a\u4f8b\u521b\u5efa\u8fdc\u7a0b\u7f13\u5b58\u5ba2\u6237\u7aef",level:3},{value:"\u6307\u6807\u76d1\u63a7\u9009\u9879",id:"\u6307\u6807\u76d1\u63a7\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u76d1\u63a7\u88c5\u9970\u5668",id:"\u793a\u4f8b\u521b\u5efa\u76d1\u63a7\u88c5\u9970\u5668",level:3},{value:"API \u670d\u52a1\u5668\u9009\u9879",id:"api-\u670d\u52a1\u5668\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u521b\u5efa API \u670d\u52a1\u5668",id:"\u793a\u4f8b\u521b\u5efa-api-\u670d\u52a1\u5668",level:3},{value:"\u4e00\u81f4\u6027\u7b56\u7565\u9009\u9879",id:"\u4e00\u81f4\u6027\u7b56\u7565\u9009\u9879",level:2},{value:"Cache Aside \u9009\u9879",id:"cache-aside-\u9009\u9879",level:3},{value:"Write Through \u9009\u9879",id:"write-through-\u9009\u9879",level:3},{value:"MQ \u901a\u77e5\u5668\u9009\u9879",id:"mq-\u901a\u77e5\u5668\u9009\u9879",level:3},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u4e00\u81f4\u6027\u7b56\u7565",id:"\u793a\u4f8b\u521b\u5efa\u4e00\u81f4\u6027\u7b56\u7565",level:3},{value:"\u590d\u5236\u9009\u9879",id:"\u590d\u5236\u9009\u9879",level:2},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u590d\u5236\u8282\u70b9",id:"\u793a\u4f8b\u521b\u5efa\u590d\u5236\u8282\u70b9",level:3},{value:"\u96c6\u6210\u9009\u9879",id:"\u96c6\u6210\u9009\u9879",level:2},{value:"\u5206\u7247\u96c6\u7fa4\u7f13\u5b58\u9009\u9879",id:"\u5206\u7247\u96c6\u7fa4\u7f13\u5b58\u9009\u9879",level:3},{value:"\u4e3b\u4ece\u96c6\u7fa4\u9009\u9879",id:"\u4e3b\u4ece\u96c6\u7fa4\u9009\u9879",level:3},{value:"\u793a\u4f8b\uff1a\u521b\u5efa\u96c6\u6210\u7f13\u5b58",id:"\u793a\u4f8b\u521b\u5efa\u96c6\u6210\u7f13\u5b58",level:3},{value:"\u7ec4\u5408\u4f7f\u7528\u9009\u9879",id:"\u7ec4\u5408\u4f7f\u7528\u9009\u9879",level:2}];function x(e){const d={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,c.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(d.header,{children:(0,n.jsx)(d.h1,{id:"config-options",children:"Config Options"})}),"\n",(0,n.jsx)(d.p,{children:"\u672c\u6587\u6863\u8be6\u7ec6\u4ecb\u7ecd\u4e86 FyerCache \u4e2d\u6240\u6709\u53ef\u7528\u7684\u914d\u7f6e\u9009\u9879\uff0c\u6309\u7ec4\u4ef6\u7c7b\u522b\u8fdb\u884c\u7ec4\u7ec7\u3002"}),"\n",(0,n.jsx)(d.h2,{id:"\u5185\u5b58\u7f13\u5b58\u9009\u9879",children:"\u5185\u5b58\u7f13\u5b58\u9009\u9879"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.code,{children:"MemoryCache"})," \u7684\u9009\u9879\u7528\u4e8e\u914d\u7f6e\u5185\u5b58\u7f13\u5b58\u7684\u884c\u4e3a\uff0c\u5982\u6e05\u7406\u95f4\u9694\u3001\u5206\u7247\u6570\u91cf\u548c\u56de\u8c03\u51fd\u6570\u7b49\u3002"]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithEvictionCallback"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5f53\u7f13\u5b58\u9879\u88ab\u9a71\u9010\u65f6\u8c03\u7528\u7684\u56de\u8c03\u51fd\u6570"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithEvictionCallback(func(key string, value any) { log.Printf("Evicted: %s", key) })'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanupInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6e05\u7406\u8fc7\u671f\u9879\u7684\u95f4\u9694\u65f6\u95f4"}),(0,n.jsx)(d.td,{children:"2 \u5206\u949f"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanupInterval(5 * time.Minute)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithShardCount"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u7f13\u5b58\u5185\u90e8\u5206\u7247\u6570\u91cf\uff0c\u63d0\u9ad8\u5e76\u53d1\u6027\u80fd"}),(0,n.jsx)(d.td,{children:"32"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithShardCount(64)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithAsyncCleanup"})}),(0,n.jsx)(d.td,{children:"\u542f\u7528\u5f02\u6b65\u6e05\u7406\u673a\u5236\uff0c\u964d\u4f4e\u6e05\u7406\u5bf9\u4e3b\u7ebf\u7a0b\u7684\u5f71\u54cd"}),(0,n.jsx)(d.td,{children:"false"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithAsyncCleanup(true)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CacheWithWorkerCount"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5f02\u6b65\u6e05\u7406\u5de5\u4f5c\u534f\u7a0b\u6570\u91cf"}),(0,n.jsx)(d.td,{children:"CPU \u6838\u5fc3\u6570"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CacheWithWorkerCount(8)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CacheWithQueueSize"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5f02\u6b65\u6e05\u7406\u4efb\u52a1\u961f\u5217\u5927\u5c0f"}),(0,n.jsx)(d.td,{children:"128"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"CacheWithQueueSize(256)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u5185\u5b58\u7f13\u5b58",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u5185\u5b58\u7f13\u5b58"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'cache := cache.NewMemoryCache(\r\n    cache.WithCleanupInterval(1 * time.Minute),\r\n    cache.WithShardCount(64),\r\n    cache.WithAsyncCleanup(true),\r\n    cache.WithEvictionCallback(func(key string, value any) {\r\n        log.Printf("Key evicted: %s", key)\r\n    }),\r\n)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u6e05\u7406\u5668\u9009\u9879",children:"\u6e05\u7406\u5668\u9009\u9879"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.code,{children:"Cleaner"})," \u7684\u9009\u9879\u7528\u4e8e\u914d\u7f6e\u7f13\u5b58\u6e05\u7406\u5668\u7684\u884c\u4e3a\uff0c\u4e3b\u8981\u7528\u4e8e\u5f02\u6b65\u6e05\u7406\u6a21\u5f0f\u3002"]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanerWorkerCount"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6e05\u7406\u5668\u5de5\u4f5c\u534f\u7a0b\u6570\u91cf"}),(0,n.jsx)(d.td,{children:"4"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanerWorkerCount(8)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanerInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6e05\u7406\u95f4\u9694\u65f6\u95f4"}),(0,n.jsx)(d.td,{children:"2 \u5206\u949f"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanerInterval(30 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanerQueueSize"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6e05\u7406\u4efb\u52a1\u961f\u5217\u5927\u5c0f"}),(0,n.jsx)(d.td,{children:"128"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanerQueueSize(256)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanerEvictionCallback"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6e05\u7406\u5668\u7684\u6dd8\u6c70\u56de\u8c03\u51fd\u6570"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCleanerEvictionCallback(onEvict)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u6e05\u7406\u5668",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u6e05\u7406\u5668"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:"cleaner := cache.NewCleaner(\r\n    shardedMap,\r\n    cache.WithCleanerWorkerCount(8),\r\n    cache.WithCleanInterval(30 * time.Second),\r\n    cache.WithQueueSize(256),\r\n)\n"})}),"\n",(0,n.jsx)(d.h2,{id:"\u5206\u7247\u7f13\u5b58\u9009\u9879",children:"\u5206\u7247\u7f13\u5b58\u9009\u9879"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.code,{children:"NodeShardedCache"})," \u7684\u9009\u9879\u7528\u4e8e\u914d\u7f6e\u57fa\u4e8e\u8282\u70b9\u7684\u5206\u7247\u7f13\u5b58\uff0c\u4e3b\u8981\u6d89\u53ca\u4e00\u81f4\u6027\u54c8\u5e0c\u53c2\u6570\u3002"]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeHashReplicas"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6bcf\u4e2a\u7269\u7406\u8282\u70b9\u7684\u865a\u62df\u8282\u70b9\u6570\u91cf"}),(0,n.jsx)(d.td,{children:"100"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeHashReplicas(200)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeCustomHashFunc"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u81ea\u5b9a\u4e49\u54c8\u5e0c\u51fd\u6570"}),(0,n.jsx)(d.td,{children:"CRC32"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeCustomHashFunc(fnvHash)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeReplicaFactor"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6570\u636e\u590d\u5236\u7684\u526f\u672c\u56e0\u5b50\uff08\u6bcf\u4e2a\u952e\u590d\u5236\u5230\u591a\u5c11\u4e2a\u8282\u70b9\uff09"}),(0,n.jsx)(d.td,{children:"1"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeReplicaFactor(2)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u5206\u7247\u7f13\u5b58",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u5206\u7247\u7f13\u5b58"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'shardedCache := cache.NewNodeShardedCache(\r\n    cache.WithNodeHashReplicas(200),\r\n    cache.WithNodeReplicaFactor(3),\r\n)\r\n\r\n// \u6dfb\u52a0\u8282\u70b9\r\nshardedCache.AddNode("node1", node1Cache, 1)  // \u6743\u91cd\u4e3a1\r\nshardedCache.AddNode("node2", node2Cache, 2)  // \u6743\u91cd\u4e3a2\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u96c6\u7fa4\u8282\u70b9\u9009\u9879",children:"\u96c6\u7fa4\u8282\u70b9\u9009\u9879"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.code,{children:"Node"})," \u7684\u9009\u9879\u7528\u4e8e\u914d\u7f6e\u96c6\u7fa4\u8282\u70b9\u7684\u884c\u4e3a\uff0c\u5305\u62ec\u901a\u4fe1\u53c2\u6570\u3001\u65f6\u95f4\u95f4\u9694\u7b49\u3002"]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeID"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9\u552f\u4e00\u6807\u8bc6\u7b26"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithNodeID("node-1")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithBindAddr"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9\u7ed1\u5b9a\u5730\u5740"}),(0,n.jsx)(d.td,{children:'":7946"'}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithBindAddr("192.168.1.100:7946")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithGossipInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e Gossip \u534f\u8bae\u901a\u4fe1\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"1 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithGossipInterval(500 * time.Millisecond)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSyncInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6570\u636e\u540c\u6b65\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"30 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSyncInterval(10 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithProbeInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9\u5065\u5eb7\u68c0\u67e5\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"1 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithProbeInterval(2 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithProbeTimeout"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5065\u5eb7\u68c0\u67e5\u8d85\u65f6\u65f6\u95f4"}),(0,n.jsx)(d.td,{children:"500 \u6beb\u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithProbeTimeout(1 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSuspicionMult"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u53ef\u7591\u72b6\u6001\u4e58\u6570"}),(0,n.jsx)(d.td,{children:"3"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSuspicionMult(5)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSyncConcurrency"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6570\u636e\u540c\u6b65\u5e76\u53d1\u6570"}),(0,n.jsx)(d.td,{children:"2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSyncConcurrency(4)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithVirtualNodes"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u865a\u62df\u8282\u70b9\u6570\u91cf"}),(0,n.jsx)(d.td,{children:"100"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithVirtualNodes(200)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMaxRetries"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6700\u5927\u91cd\u8bd5\u6b21\u6570"}),(0,n.jsx)(d.td,{children:"3"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMaxRetries(5)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRetryInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u91cd\u8bd5\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"200 \u6beb\u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRetryInterval(100 * time.Millisecond)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithEventBufferSize"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u4e8b\u4ef6\u901a\u9053\u7f13\u51b2\u533a\u5927\u5c0f"}),(0,n.jsx)(d.td,{children:"100"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithEventBufferSize(200)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u96c6\u7fa4\u8282\u70b9",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u96c6\u7fa4\u8282\u70b9"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'node, err := cluster.NewNode(\r\n    "node-1",\r\n    localCache,\r\n    cluster.WithBindAddr("192.168.1.100:7946"),\r\n    cluster.WithGossipInterval(500 * time.Millisecond),\r\n    cluster.WithProbeInterval(1 * time.Second),\r\n    cluster.WithSuspicionMult(3),\r\n    cluster.WithEventBufferSize(100),\r\n)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u5206\u5e03\u5f0f\u7f13\u5b58\u9009\u9879",children:"\u5206\u5e03\u5f0f\u7f13\u5b58\u9009\u9879"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.code,{children:"DistributedCache"})," \u7684\u9009\u9879\u7528\u4e8e\u914d\u7f6e\u5206\u5e03\u5f0f\u7f13\u5b58\u7684\u884c\u4e3a\u3002"]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeID"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9\u552f\u4e00\u6807\u8bc6\u7b26"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithNodeID("dist-node-1")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithAddress"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9\u5730\u5740"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithAddress("192.168.1.100:8080")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithWeight"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9\u6743\u91cd"}),(0,n.jsx)(d.td,{children:"1"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithWeight(2)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithReplicaFactor"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u590d\u5236\u56e0\u5b50"}),(0,n.jsx)(d.td,{children:"1"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithReplicaFactor(3)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithVirtualNodes"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u4e00\u81f4\u6027\u54c8\u5e0c\u73af\u4e2d\u7684\u865a\u62df\u8282\u70b9\u6570\u91cf"}),(0,n.jsx)(d.td,{children:"100"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithVirtualNodes(200)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithOperationTimeout"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u64cd\u4f5c\u8d85\u65f6\u65f6\u95f4"}),(0,n.jsx)(d.td,{children:"2 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithOperationTimeout(1 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRetryOptions"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u91cd\u8bd5\u53c2\u6570"}),(0,n.jsx)(d.td,{children:"\u6700\u5927\u91cd\u8bd5 3 \u6b21\uff0c\u95f4\u9694 100ms"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRetryOptions(5, 200 * time.Millisecond)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u914d\u7f6e\u5206\u5e03\u5f0f\u7f13\u5b58",children:"\u793a\u4f8b\uff1a\u914d\u7f6e\u5206\u5e03\u5f0f\u7f13\u5b58"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'config := distributed.NewDistributedCacheConfig()\r\nconfig = distributed.WithNodeID("node-1")(config)\r\nconfig = distributed.WithAddress("192.168.1.100:7946")(config)\r\nconfig = distributed.WithReplicaFactor(2)(config)\r\nconfig = distributed.WithOperationTimeout(3 * time.Second)(config)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u8fdc\u7a0b\u7f13\u5b58\u9009\u9879",children:"\u8fdc\u7a0b\u7f13\u5b58\u9009\u9879"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.code,{children:"RemoteCache"})," \u7684\u9009\u9879\u7528\u4e8e\u914d\u7f6e\u4e0e\u8fdc\u7a0b\u7f13\u5b58\u8282\u70b9\u7684\u8fde\u63a5\u3002"]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithTimeout"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8fdc\u7a0b\u64cd\u4f5c\u8d85\u65f6\u65f6\u95f4"}),(0,n.jsx)(d.td,{children:"2 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithTimeout(500 * time.Millisecond)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRetry"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u91cd\u8bd5\u53c2\u6570"}),(0,n.jsx)(d.td,{children:"\u6700\u5927\u91cd\u8bd5 3 \u6b21\uff0c\u95f4\u9694 100ms"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRetry(5, 200 * time.Millisecond)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithDebugLog"})}),(0,n.jsx)(d.td,{children:"\u542f\u7528\u8c03\u8bd5\u65e5\u5fd7"}),(0,n.jsx)(d.td,{children:"false"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithDebugLog(true)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u8fdc\u7a0b\u7f13\u5b58\u5ba2\u6237\u7aef",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u8fdc\u7a0b\u7f13\u5b58\u5ba2\u6237\u7aef"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'remoteCache := distributed.NewRemoteCache(\r\n    "remote-node-1",\r\n    "cache.example.com:8080",\r\n    distributed.WithTimeout(500 * time.Millisecond),\r\n    distributed.WithRetry(3, 100 * time.Millisecond),\r\n    distributed.WithDebugLog(true),\r\n)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u6307\u6807\u76d1\u63a7\u9009\u9879",children:"\u6307\u6807\u76d1\u63a7\u9009\u9879"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.code,{children:"MonitoredCache"})," \u7684\u9009\u9879\u7528\u4e8e\u914d\u7f6e\u7f13\u5b58\u6307\u6807\u76d1\u63a7\u3002"]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMetricsServer"})}),(0,n.jsx)(d.td,{children:"\u914d\u7f6e\u6307\u6807 HTTP \u670d\u52a1\u5668\u5730\u5740"}),(0,n.jsx)(d.td,{children:'":8080"'}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithMetricsServer(":9090")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMetricsPath"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6307\u6807\u8def\u5f84"}),(0,n.jsx)(d.td,{children:'"/metrics"'}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithMetricsPath("/custom/metrics")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCollectInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6307\u6807\u6536\u96c6\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"1 \u5206\u949f"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCollectInterval(30 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMemoryUpdateInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5185\u5b58\u4f7f\u7528\u7edf\u8ba1\u66f4\u65b0\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"1 \u5206\u949f"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMemoryUpdateInterval(30 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNamespace"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6307\u6807\u547d\u540d\u7a7a\u95f4"}),(0,n.jsx)(d.td,{children:'"fyercache"'}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithNamespace("myapp")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSubsystem"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6307\u6807\u5b50\u7cfb\u7edf\u540d\u79f0"}),(0,n.jsx)(d.td,{children:'"cache"'}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithSubsystem("redis")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithEnableMemStats"})}),(0,n.jsx)(d.td,{children:"\u542f\u7528\u6216\u7981\u7528\u5185\u5b58\u7edf\u8ba1"}),(0,n.jsx)(d.td,{children:"true"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithEnableMemStats(true)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithLabels"})}),(0,n.jsx)(d.td,{children:"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u6807\u7b7e"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithLabels(map[string]string{"env": "prod"})'})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u76d1\u63a7\u88c5\u9970\u5668",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u76d1\u63a7\u88c5\u9970\u5668"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'monitoredCache := metrics.NewMonitoredCache(\r\n    originalCache,\r\n    metrics.WithMetricsServer(":8080"),\r\n    metrics.WithCollectInterval(1 * time.Minute),\r\n    metrics.WithLabels(map[string]string{\r\n        "service": "user-service",\r\n        "env":     "production",\r\n    }),\r\n)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"api-\u670d\u52a1\u5668\u9009\u9879",children:"API \u670d\u52a1\u5668\u9009\u9879"}),"\n",(0,n.jsxs)(d.p,{children:[(0,n.jsx)(d.code,{children:"APIServer"})," \u7684\u9009\u9879\u7528\u4e8e\u914d\u7f6e API \u670d\u52a1\u5668\u7684\u884c\u4e3a\u3002"]}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithBindAddress"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u670d\u52a1\u5668\u7ed1\u5b9a\u5730\u5740"}),(0,n.jsx)(d.td,{children:'":8080"'}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithBindAddress(":9000")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithBasePath"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e API \u57fa\u7840\u8def\u5f84"}),(0,n.jsx)(d.td,{children:'"/api"'}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithBasePath("/cache/api")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithTimeouts"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6240\u6709\u8d85\u65f6\u53c2\u6570"}),(0,n.jsx)(d.td,{children:"\u8bfb/\u5199 10s\uff0c\u7a7a\u95f2 60s"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithTimeouts(5*time.Second, 5*time.Second, 30*time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithReadTimeout"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8bfb\u53d6\u8d85\u65f6"}),(0,n.jsx)(d.td,{children:"10 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithReadTimeout(5 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithWriteTimeout"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5199\u5165\u8d85\u65f6"}),(0,n.jsx)(d.td,{children:"10 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithWriteTimeout(5 * time.Second)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa-api-\u670d\u52a1\u5668",children:"\u793a\u4f8b\uff1a\u521b\u5efa API \u670d\u52a1\u5668"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'apiServer := api.NewAPIServer(\r\n    cache,\r\n    api.WithBindAddress(":8081"),\r\n    api.WithBasePath("/cache/api"),\r\n    api.WithTimeouts(5*time.Second, 5*time.Second, 30*time.Second),\r\n)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u4e00\u81f4\u6027\u7b56\u7565\u9009\u9879",children:"\u4e00\u81f4\u6027\u7b56\u7565\u9009\u9879"}),"\n",(0,n.jsx)(d.p,{children:"\u7528\u4e8e\u914d\u7f6e\u7f13\u5b58\u4e00\u81f4\u6027\u7b56\u7565\uff0c\u5305\u62ec Cache Aside\u3001Write Through \u548c\u57fa\u4e8e\u6d88\u606f\u961f\u5217\u7684\u901a\u77e5\u7b56\u7565\u3002"}),"\n",(0,n.jsx)(d.h3,{id:"cache-aside-\u9009\u9879",children:"Cache Aside \u9009\u9879"}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCacheAsideTTL"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u7f13\u5b58\u9ed8\u8ba4 TTL"}),(0,n.jsx)(d.td,{children:"5 \u5206\u949f"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCacheAsideTTL(10 * time.Minute)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCacheAsideWriteOnMiss"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u672a\u547d\u4e2d\u65f6\u662f\u5426\u5199\u5165\u7f13\u5b58"}),(0,n.jsx)(d.td,{children:"true"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithCacheAsideWriteOnMiss(false)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"write-through-\u9009\u9879",children:"Write Through \u9009\u9879"}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithWriteThroughTTL"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u7f13\u5b58\u9ed8\u8ba4 TTL"}),(0,n.jsx)(d.td,{children:"5 \u5206\u949f"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithWriteThroughTTL(10 * time.Minute)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithDelayedWrite"})}),(0,n.jsx)(d.td,{children:"\u542f\u7528\u5ef6\u8fdf\u5199\u5165\u53ca\u8bbe\u7f6e\u5ef6\u8fdf\u65f6\u95f4"}),(0,n.jsx)(d.td,{children:"false, 100ms"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithDelayedWrite(true, 100 * time.Millisecond)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"mq-\u901a\u77e5\u5668\u9009\u9879",children:"MQ \u901a\u77e5\u5668\u9009\u9879"}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMQTopic"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6d88\u606f\u4e3b\u9898"}),(0,n.jsxs)(d.td,{children:['"cache',":consistency",'"']}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithMQTopic("cache:invalidation")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMQRetry"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u91cd\u8bd5\u7b56\u7565"}),(0,n.jsx)(d.td,{children:"3 \u6b21\uff0c\u65e0\u5ef6\u8fdf"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMQRetry(5, 100 * time.Millisecond)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMQNotifierTTL"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u7f13\u5b58\u9ed8\u8ba4 TTL"}),(0,n.jsx)(d.td,{children:"5 \u5206\u949f"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMQNotifierTTL(10 * time.Minute)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u4e00\u81f4\u6027\u7b56\u7565",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u4e00\u81f4\u6027\u7b56\u7565"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'// Cache Aside \u7b56\u7565\r\ncacheAsideStrategy := consistency.NewCacheAsideStrategy(\r\n    cache,\r\n    dataSource,\r\n    consistency.WithCacheAsideTTL(10 * time.Minute),\r\n    consistency.WithCacheAsideWriteOnMiss(true),\r\n)\r\n\r\n// Write Through \u7b56\u7565\r\nwriteThroughStrategy := consistency.NewWriteThroughStrategy(\r\n    cache,\r\n    dataSource,\r\n    consistency.WithWriteThroughTTL(10 * time.Minute),\r\n    consistency.WithDelayedWrite(true, 100 * time.Millisecond),\r\n)\r\n\r\n// MQ \u901a\u77e5\u5668\u7b56\u7565\r\nmqStrategy := consistency.NewMQNotifierStrategy(\r\n    cache,\r\n    dataSource,\r\n    mqPublisher,\r\n    consistency.WithMQTopic("cache:invalidation"),\r\n    consistency.WithMQNotifierTTL(10 * time.Minute),\r\n)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u590d\u5236\u9009\u9879",children:"\u590d\u5236\u9009\u9879"}),"\n",(0,n.jsx)(d.p,{children:"\u7528\u4e8e\u914d\u7f6e\u590d\u5236\u7cfb\u7edf\u7684\u9009\u9879\uff0c\u9002\u7528\u4e8e Leader \u8282\u70b9\u548c Follower \u8282\u70b9\u3002"}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithNodeID"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9 ID"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithNodeID("repl-node-1")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithAddress"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9\u5730\u5740"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithAddress("localhost:8080")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRole"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u8282\u70b9\u89d2\u8272"}),(0,n.jsx)(d.td,{children:"RoleFollower"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRole(replication.RoleLeader)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithHeartbeatInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5fc3\u8df3\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"500 \u6beb\u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithHeartbeatInterval(1 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithElectionTimeout"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u9009\u4e3e\u8d85\u65f6"}),(0,n.jsx)(d.td,{children:"1 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithElectionTimeout(2 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMaxLogEntries"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5355\u6b21\u540c\u6b65\u6700\u5927\u65e5\u5fd7\u6761\u76ee\u6570"}),(0,n.jsx)(d.td,{children:"1000"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMaxLogEntries(2000)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSnapshotThreshold"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u89e6\u53d1\u5feb\u7167\u7684\u65e5\u5fd7\u6761\u76ee\u9608\u503c"}),(0,n.jsx)(d.td,{children:"10000"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSnapshotThreshold(20000)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMaxRetries"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6700\u5927\u91cd\u8bd5\u6b21\u6570"}),(0,n.jsx)(d.td,{children:"3"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithMaxRetries(5)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRetryInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u91cd\u8bd5\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"200 \u6beb\u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithRetryInterval(100 * time.Millisecond)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithReplicationTimeout"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u590d\u5236\u8d85\u65f6"}),(0,n.jsx)(d.td,{children:"5 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithReplicationTimeout(10 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithPriority"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u9009\u4e3e\u4f18\u5148\u7ea7"}),(0,n.jsx)(d.td,{children:"0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithPriority(10)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u590d\u5236\u8282\u70b9",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u590d\u5236\u8282\u70b9"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'// \u521b\u5efa\u4e3b\u8282\u70b9\r\nleaderNode := replication.NewLeaderNode(\r\n    "leader-1",\r\n    cache,\r\n    log,\r\n    syncer,\r\n    replication.WithHeartbeatInterval(500 * time.Millisecond),\r\n    replication.WithMaxRetries(3),\r\n    replication.WithPriority(10),\r\n)\r\n\r\n// \u521b\u5efa\u4ece\u8282\u70b9\r\nfollowerNode := replication.NewFollowerNode(\r\n    "follower-1",\r\n    cache,\r\n    log,\r\n    syncer,\r\n    replication.WithElectionTimeout(2 * time.Second),\r\n    replication.WithMaxLogEntries(1000),\r\n)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u96c6\u6210\u9009\u9879",children:"\u96c6\u6210\u9009\u9879"}),"\n",(0,n.jsx)(d.h3,{id:"\u5206\u7247\u96c6\u7fa4\u7f13\u5b58\u9009\u9879",children:"\u5206\u7247\u96c6\u7fa4\u7f13\u5b58\u9009\u9879"}),"\n",(0,n.jsx)(d.p,{children:"\u7528\u4e8e\u914d\u7f6e\u5206\u7247\u96c6\u7fa4\u7f13\u5b58\u7684\u884c\u4e3a\u3002"}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithVirtualNodeCount"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u4e00\u81f4\u6027\u54c8\u5e0c\u73af\u4e2d\u7684\u865a\u62df\u8282\u70b9\u6570\u91cf"}),(0,n.jsx)(d.td,{children:"100"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithVirtualNodeCount(200)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithReplicaFactor"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u6570\u636e\u590d\u5236\u7684\u526f\u672c\u56e0\u5b50"}),(0,n.jsx)(d.td,{children:"1"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithReplicaFactor(2)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u4e3b\u4ece\u96c6\u7fa4\u9009\u9879",children:"\u4e3b\u4ece\u96c6\u7fa4\u9009\u9879"}),"\n",(0,n.jsx)(d.p,{children:"\u7528\u4e8e\u914d\u7f6e\u4e3b\u4ece\u67b6\u6784\u96c6\u7fa4\u7684\u884c\u4e3a\u3002"}),"\n",(0,n.jsxs)(d.table,{children:[(0,n.jsx)(d.thead,{children:(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.th,{children:"\u9009\u9879"}),(0,n.jsx)(d.th,{children:"\u63cf\u8ff0"}),(0,n.jsx)(d.th,{children:"\u9ed8\u8ba4\u503c"}),(0,n.jsx)(d.th,{children:"\u793a\u4f8b\u7528\u6cd5"})]})}),(0,n.jsxs)(d.tbody,{children:[(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithSyncerAddress"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u540c\u6b65\u5668\u5730\u5740"}),(0,n.jsx)(d.td,{children:"\u65e0"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:'WithSyncerAddress("localhost:8080")'})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithInitialRole"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u521d\u59cb\u89d2\u8272"}),(0,n.jsx)(d.td,{children:"RoleFollower"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithInitialRole(replication.RoleLeader)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithElectionTimeout"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u9009\u4e3e\u8d85\u65f6"}),(0,n.jsx)(d.td,{children:"1 \u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithElectionTimeout(2 * time.Second)"})})]}),(0,n.jsxs)(d.tr,{children:[(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithHeartbeatInterval"})}),(0,n.jsx)(d.td,{children:"\u8bbe\u7f6e\u5fc3\u8df3\u95f4\u9694"}),(0,n.jsx)(d.td,{children:"500 \u6beb\u79d2"}),(0,n.jsx)(d.td,{children:(0,n.jsx)(d.code,{children:"WithHeartbeatInterval(1 * time.Second)"})})]})]})]}),"\n",(0,n.jsx)(d.h3,{id:"\u793a\u4f8b\u521b\u5efa\u96c6\u6210\u7f13\u5b58",children:"\u793a\u4f8b\uff1a\u521b\u5efa\u96c6\u6210\u7f13\u5b58"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'// \u521b\u5efa\u5206\u7247\u96c6\u7fa4\u7f13\u5b58\r\nshardedClusterCache, err := integration.NewShardedClusterCache(\r\n    localCache,\r\n    "node-1",\r\n    "localhost:7946",\r\n    []cluster.NodeOption{\r\n        cluster.WithGossipInterval(500 * time.Millisecond),\r\n    },\r\n    []integration.ShardedClusterCacheOption{\r\n        integration.WithVirtualNodeCount(200),\r\n        integration.WithReplicaFactor(2),\r\n    },\r\n)\r\n\r\n// \u521b\u5efa\u4e3b\u4ece\u96c6\u7fa4\u7f13\u5b58\r\nleaderFollowerCluster, err := integration.NewLeaderFollowerCluster(\r\n    "node-1",\r\n    "localhost:7946",\r\n    localCache,\r\n    []cluster.NodeOption{\r\n        cluster.WithGossipInterval(500 * time.Millisecond),\r\n    },\r\n    []integration.LeaderFollowerClusterOption{\r\n        integration.WithSyncerAddress("localhost:8080"),\r\n        integration.WithInitialRole(replication.RoleLeader),\r\n    },\r\n)\n'})}),"\n",(0,n.jsx)(d.h2,{id:"\u7ec4\u5408\u4f7f\u7528\u9009\u9879",children:"\u7ec4\u5408\u4f7f\u7528\u9009\u9879"}),"\n",(0,n.jsx)(d.p,{children:"FyerCache \u7684\u5404\u79cd\u9009\u9879\u53ef\u4ee5\u7ec4\u5408\u4f7f\u7528\uff0c\u521b\u5efa\u9ad8\u5ea6\u5b9a\u5236\u5316\u7684\u7f13\u5b58\u5b9e\u4f8b\u3002\u4ee5\u4e0b\u662f\u4e00\u4e2a\u7ec4\u5408\u591a\u79cd\u9009\u9879\u7684\u793a\u4f8b\uff1a"}),"\n",(0,n.jsx)(d.pre,{children:(0,n.jsx)(d.code,{className:"language-go",children:'// \u521b\u5efa\u57fa\u7840\u5185\u5b58\u7f13\u5b58\r\nmemCache := cache.NewMemoryCache(\r\n    cache.WithShardCount(64),\r\n    cache.WithCleanupInterval(30 * time.Second),\r\n    cache.WithAsyncCleanup(true),\r\n)\r\n\r\n// \u6dfb\u52a0\u76d1\u63a7\u88c5\u9970\u5668\r\nmonitoredCache := metrics.NewMonitoredCache(\r\n    memCache,\r\n    metrics.WithMetricsServer(":8080"),\r\n    metrics.WithLabels(map[string]string{"env": "production"}),\r\n)\r\n\r\n// \u521b\u5efa\u5206\u5e03\u5f0f\u96c6\u7fa4\u7f13\u5b58\r\nclusterCache, err := cluster.NewClusterCache(\r\n    monitoredCache,\r\n    "node-1",\r\n    ":7946",\r\n    cluster.WithGossipInterval(500 * time.Millisecond),\r\n    cluster.WithProbeInterval(1 * time.Second),\r\n)\r\n\r\n// \u521b\u5efa API \u670d\u52a1\u5668\r\napiServer := api.NewAPIServer(\r\n    clusterCache,\r\n    api.WithBindAddress(":8081"),\r\n    api.WithBasePath("/cache/api"),\r\n)\n'})})]})}function j(e={}){const{wrapper:d}={...(0,c.R)(),...e.components};return d?(0,n.jsx)(d,{...e,children:(0,n.jsx)(x,{...e})}):x(e)}},8453:(e,d,i)=>{i.d(d,{R:()=>t,x:()=>h});var r=i(6540);const n={},c=r.createContext(n);function t(e){const d=r.useContext(c);return r.useMemo((function(){return"function"==typeof e?e(d):{...d,...e}}),[d,e])}function h(e){let d;return d=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:t(e.components),r.createElement(c.Provider,{value:d},e.children)}}}]);