"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[954],{93:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>o,frontMatter:()=>t,metadata:()=>c,toc:()=>h});const c=JSON.parse('{"id":"api-reference/cache-interface","title":"Cache Interface & Method","description":"\u6838\u5fc3\u63a5\u53e3 Cache","source":"@site/docs/api-reference/cache-interface.md","sourceDirName":"api-reference","slug":"/api-reference/cache-interface","permalink":"/fyer-cache/docs/api-reference/cache-interface","draft":false,"unlisted":false,"editUrl":"https://github.com/fyerfyer/fyer-rpc/tree/main/docs/api-reference/cache-interface.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","next":{"title":"Cluster-Management API","permalink":"/fyer-cache/docs/api-reference/cluster-api"}}');var i=r(4848),s=r(8453);const t={},d="Cache Interface & Method",l={},h=[{value:"\u6838\u5fc3\u63a5\u53e3 Cache",id:"\u6838\u5fc3\u63a5\u53e3-cache",level:2},{value:"Get \u65b9\u6cd5",id:"get-\u65b9\u6cd5",level:3},{value:"Set \u65b9\u6cd5",id:"set-\u65b9\u6cd5",level:3},{value:"Del \u65b9\u6cd5",id:"del-\u65b9\u6cd5",level:3},{value:"\u6269\u5c55\u63a5\u53e3",id:"\u6269\u5c55\u63a5\u53e3",level:2},{value:"DistributedCache \u63a5\u53e3",id:"distributedcache-\u63a5\u53e3",level:3},{value:"\u672c\u5730\u64cd\u4f5c\u65b9\u6cd5",id:"\u672c\u5730\u64cd\u4f5c\u65b9\u6cd5",level:4},{value:"\u8282\u70b9\u7ba1\u7406\u65b9\u6cd5",id:"\u8282\u70b9\u7ba1\u7406\u65b9\u6cd5",level:4},{value:"ShardedCache \u63a5\u53e3",id:"shardedcache-\u63a5\u53e3",level:3},{value:"\u4e3b\u8981\u5b9e\u73b0",id:"\u4e3b\u8981\u5b9e\u73b0",level:2},{value:"MemoryCache",id:"memorycache",level:3},{value:"NodeShardedCache",id:"nodeshardedcache",level:3},{value:"ClusterCache",id:"clustercache",level:3},{value:"RemoteCache",id:"remotecache",level:3},{value:"\u7f13\u5b58\u4e00\u81f4\u6027\u7b56\u7565",id:"\u7f13\u5b58\u4e00\u81f4\u6027\u7b56\u7565",level:2},{value:"CacheAsideStrategy",id:"cacheasidestrategy",level:3},{value:"WriteThroughStrategy",id:"writethroughstrategy",level:3},{value:"MQNotifierStrategy",id:"mqnotifierstrategy",level:3}];function a(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"cache-interface--method",children:"Cache Interface & Method"})}),"\n",(0,i.jsx)(n.h2,{id:"\u6838\u5fc3\u63a5\u53e3-cache",children:"\u6838\u5fc3\u63a5\u53e3 Cache"}),"\n",(0,i.jsxs)(n.p,{children:["\u6240\u6709 FyerCache \u5b9e\u73b0\u90fd\u57fa\u4e8e ",(0,i.jsx)(n.code,{children:"cache.Cache"})," \u63a5\u53e3\uff0c\u5b9a\u4e49\u4e86\u4e09\u4e2a\u6838\u5fc3\u65b9\u6cd5\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"type Cache interface {\r\n    Get(ctx context.Context, key string) (any, error)\r\n    Set(ctx context.Context, key string, val any, expiration time.Duration) error\r\n    Del(ctx context.Context, key string) error\r\n}\n"})}),"\n",(0,i.jsx)(n.h3,{id:"get-\u65b9\u6cd5",children:"Get \u65b9\u6cd5"}),"\n",(0,i.jsx)(n.p,{children:"\u4ece\u7f13\u5b58\u4e2d\u68c0\u7d22\u4e0e\u6307\u5b9a\u952e\u5173\u8054\u7684\u503c\u3002"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u7b7e\u540d"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"Get(ctx context.Context, key string) (any, error)\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ctx context.Context"}),"\uff1a\u4e0a\u4e0b\u6587\u5bf9\u8c61\uff0c\u7528\u4e8e\u4f20\u9012\u8bf7\u6c42\u8303\u56f4\u7684\u503c\u3001\u53d6\u6d88\u4fe1\u53f7\u548c\u622a\u6b62\u65f6\u95f4"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"key string"}),"\uff1a\u8981\u68c0\u7d22\u7684\u7f13\u5b58\u9879\u7684\u952e"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"any"}),"\uff1a\u5b58\u50a8\u7684\u503c\uff0c\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"error"}),"\uff1a\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u53d1\u751f\u7684\u4efb\u4f55\u9519\u8bef"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u9519\u8bef"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5982\u679c\u952e\u4e0d\u5b58\u5728\uff0c\u8fd4\u56de ",(0,i.jsx)(n.code,{children:"ferr.ErrKeyNotFound"})]}),"\n",(0,i.jsx)(n.li,{children:"\u5728\u5206\u5e03\u5f0f\u73af\u5883\u4e2d\uff0c\u53ef\u80fd\u8fd4\u56de\u7f51\u7edc\u6216\u8fdc\u7a0b\u8282\u70b9\u9519\u8bef"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u793a\u4f8b"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'value, err := cache.Get(context.Background(), "user:1001")\r\nif err != nil {\r\n    if errors.Is(err, ferr.ErrKeyNotFound) {\r\n        // \u952e\u4e0d\u5b58\u5728\r\n    } else {\r\n        // \u5176\u4ed6\u9519\u8bef\r\n    }\r\n    return\r\n}\r\n\r\n// \u4f7f\u7528\u7c7b\u578b\u65ad\u8a00\u8f6c\u6362\u4e3a\u9884\u671f\u7c7b\u578b\r\nuserInfo, ok := value.(UserInfo)\r\nif !ok {\r\n    // \u7c7b\u578b\u4e0d\u5339\u914d\r\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"set-\u65b9\u6cd5",children:"Set \u65b9\u6cd5"}),"\n",(0,i.jsx)(n.p,{children:"\u5c06\u503c\u4e0e\u6307\u5b9a\u952e\u5173\u8054\u5b58\u50a8\u5728\u7f13\u5b58\u4e2d\u3002"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u7b7e\u540d"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"Set(ctx context.Context, key string, val any, expiration time.Duration) error\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ctx context.Context"}),"\uff1a\u4e0a\u4e0b\u6587\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"key string"}),"\uff1a\u7f13\u5b58\u9879\u7684\u952e"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"val any"}),"\uff1a\u8981\u5b58\u50a8\u7684\u503c\uff0c\u53ef\u4ee5\u662f\u4efb\u4f55\u7c7b\u578b"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"expiration time.Duration"}),"\uff1a\u8fc7\u671f\u65f6\u95f4\uff0c\u4ece\u8c03\u7528 Set \u5f00\u59cb\u8ba1\u7b97","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u503c\u4e3a 0 \u8868\u793a\u6c38\u4e0d\u8fc7\u671f"}),"\n",(0,i.jsx)(n.li,{children:"\u8d1f\u503c\u901a\u5e38\u89c6\u4e3a\u7acb\u5373\u8fc7\u671f\u6216\u4f7f\u7528\u9ed8\u8ba4\u8fc7\u671f\u65f6\u95f4\uff08\u53d6\u51b3\u4e8e\u5b9e\u73b0\uff09"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"error"}),"\uff1a\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u53d1\u751f\u7684\u4efb\u4f55\u9519\u8bef"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u793a\u4f8b"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'user := UserInfo{\r\n    ID:   1001,\r\n    Name: "John Doe",\r\n    Age:  30,\r\n}\r\n\r\n// \u5b58\u50a8\u7528\u6237\u4fe1\u606f\uff0c10\u5206\u949f\u540e\u8fc7\u671f\r\nerr := cache.Set(context.Background(), "user:1001", user, 10*time.Minute)\r\nif err != nil {\r\n    // \u5904\u7406\u9519\u8bef\r\n}\r\n\r\n// \u5b58\u50a8\u4e0d\u8fc7\u671f\u7684\u503c\r\nerr = cache.Set(context.Background(), "constants:pi", 3.14159, 0)\n'})}),"\n",(0,i.jsx)(n.h3,{id:"del-\u65b9\u6cd5",children:"Del \u65b9\u6cd5"}),"\n",(0,i.jsx)(n.p,{children:"\u4ece\u7f13\u5b58\u4e2d\u5220\u9664\u6307\u5b9a\u952e\u7684\u9879\u3002"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u7b7e\u540d"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"Del(ctx context.Context, key string) error\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u53c2\u6570"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"ctx context.Context"}),"\uff1a\u4e0a\u4e0b\u6587\u5bf9\u8c61"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"key string"}),"\uff1a\u8981\u5220\u9664\u7684\u7f13\u5b58\u9879\u7684\u952e"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u8fd4\u56de\u503c"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"error"}),"\uff1a\u64cd\u4f5c\u8fc7\u7a0b\u4e2d\u53d1\u751f\u7684\u4efb\u4f55\u9519\u8bef"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u6ce8\u610f"}),"\uff1a"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"\u5982\u679c\u952e\u4e0d\u5b58\u5728\uff0c\u5927\u591a\u6570\u5b9e\u73b0\u4e0d\u4f1a\u8fd4\u56de\u9519\u8bef"}),"\n",(0,i.jsx)(n.li,{children:"\u5728\u9700\u8981\u786e\u4fdd\u952e\u5b58\u5728\u7684\u573a\u666f\u4e0b\uff0c\u5e94\u9996\u5148\u4f7f\u7528 Get \u65b9\u6cd5\u68c0\u67e5"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"\u793a\u4f8b"}),"\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'err := cache.Del(context.Background(), "user:1001")\r\nif err != nil {\r\n    // \u5904\u7406\u9519\u8bef\r\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u6269\u5c55\u63a5\u53e3",children:"\u6269\u5c55\u63a5\u53e3"}),"\n",(0,i.jsx)(n.h3,{id:"distributedcache-\u63a5\u53e3",children:"DistributedCache \u63a5\u53e3"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"distributed.DistributedCache"})," \u63a5\u53e3\u6269\u5c55\u4e86\u57fa\u672c\u7684 Cache \u63a5\u53e3\uff0c\u589e\u52a0\u4e86\u5bf9\u5206\u5e03\u5f0f\u73af\u5883\u7684\u652f\u6301\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"type DistributedCache interface {\r\n    // \u6838\u5fc3\u7f13\u5b58\u64cd\u4f5c\r\n    Get(ctx context.Context, key string) (any, error)\r\n    Set(ctx context.Context, key string, value any, expiration time.Duration) error\r\n    Del(ctx context.Context, key string) error\r\n\r\n    // \u672c\u5730\u7f13\u5b58\u64cd\u4f5c\r\n    GetLocal(ctx context.Context, key string) (any, error)\r\n    SetLocal(ctx context.Context, key string, value any, expiration time.Duration) error\r\n    DelLocal(ctx context.Context, key string) error\r\n\r\n    // \u8282\u70b9\u7ba1\u7406\r\n    NodeID() string\r\n    NodeAddress() string\r\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"\u672c\u5730\u64cd\u4f5c\u65b9\u6cd5",children:"\u672c\u5730\u64cd\u4f5c\u65b9\u6cd5"}),"\n",(0,i.jsx)(n.p,{children:"\u672c\u5730\u65b9\u6cd5\u76f4\u63a5\u64cd\u4f5c\u5f53\u524d\u8282\u70b9\u7684\u6570\u636e\uff0c\u7ed5\u8fc7\u5206\u5e03\u5f0f\u8def\u7531\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"GetLocal"})," - \u4ece\u672c\u5730\u7f13\u5b58\u83b7\u53d6\u503c\uff0c\u4e0d\u8003\u8651\u5206\u7247\u6216\u8def\u7531"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"SetLocal"})," - \u5728\u672c\u5730\u7f13\u5b58\u8bbe\u7f6e\u503c\uff0c\u4e0d\u4f20\u64ad\u5230\u5176\u4ed6\u8282\u70b9"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"DelLocal"})," - \u5220\u9664\u672c\u5730\u7f13\u5b58\u4e2d\u7684\u503c\uff0c\u4e0d\u5f71\u54cd\u5176\u4ed6\u8282\u70b9"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"\u8282\u70b9\u7ba1\u7406\u65b9\u6cd5",children:"\u8282\u70b9\u7ba1\u7406\u65b9\u6cd5"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"NodeID()"})," - \u8fd4\u56de\u5f53\u524d\u8282\u70b9\u7684\u552f\u4e00\u6807\u8bc6"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"NodeAddress()"})," - \u8fd4\u56de\u5f53\u524d\u8282\u70b9\u7684\u7f51\u7edc\u5730\u5740"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"shardedcache-\u63a5\u53e3",children:"ShardedCache \u63a5\u53e3"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"cache.ShardedCache"})," \u63a5\u53e3\u6269\u5c55\u4e86\u57fa\u672c\u7684 Cache \u63a5\u53e3\uff0c\u63d0\u4f9b\u4e86\u5206\u7247\u7f13\u5b58\u7684\u8282\u70b9\u7ba1\u7406\u529f\u80fd\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"type ShardedCache interface {\r\n    Cache\r\n\r\n    // AddNode \u6dfb\u52a0\u7f13\u5b58\u8282\u70b9\r\n    AddNode(nodeID string, cache Cache, weight int) error\r\n\r\n    // RemoveNode \u79fb\u9664\u7f13\u5b58\u8282\u70b9\r\n    RemoveNode(nodeID string) error\r\n\r\n    // GetNodeIDs \u83b7\u53d6\u6240\u6709\u8282\u70b9ID\r\n    GetNodeIDs() []string\r\n\r\n    // GetNodeCount \u83b7\u53d6\u8282\u70b9\u6570\u91cf\r\n    GetNodeCount() int\r\n}\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"AddNode"})," - \u6dfb\u52a0\u4e00\u4e2a\u65b0\u7684\u7f13\u5b58\u8282\u70b9\u5230\u5206\u7247\u96c6\u5408\u4e2d"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"RemoveNode"})," - \u4ece\u5206\u7247\u96c6\u5408\u4e2d\u79fb\u9664\u4e00\u4e2a\u7f13\u5b58\u8282\u70b9"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"GetNodeIDs"})," - \u83b7\u53d6\u6240\u6709\u7f13\u5b58\u8282\u70b9\u7684ID\u5217\u8868"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"GetNodeCount"})," - \u83b7\u53d6\u7f13\u5b58\u8282\u70b9\u7684\u603b\u6570"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"\u4e3b\u8981\u5b9e\u73b0",children:"\u4e3b\u8981\u5b9e\u73b0"}),"\n",(0,i.jsx)(n.p,{children:"FyerCache \u63d0\u4f9b\u4e86\u591a\u79cd\u7f13\u5b58\u63a5\u53e3\u7684\u5177\u4f53\u5b9e\u73b0\uff1a"}),"\n",(0,i.jsx)(n.h3,{id:"memorycache",children:"MemoryCache"}),"\n",(0,i.jsx)(n.p,{children:"\u5185\u5b58\u4e2d\u7684\u672c\u5730\u7f13\u5b58\u5b9e\u73b0\uff0c\u9002\u7528\u4e8e\u5355\u8282\u70b9\u5e94\u7528\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"cache := cache.NewMemoryCache()\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u914d\u7f6e\u9009\u9879\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WithEvictionCallback"})," - \u8bbe\u7f6e\u952e\u88ab\u6dd8\u6c70\u65f6\u7684\u56de\u8c03\u51fd\u6570"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WithCleanupInterval"})," - \u8bbe\u7f6e\u6e05\u7406\u8fc7\u671f\u952e\u7684\u95f4\u9694"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WithShardCount"})," - \u8bbe\u7f6e\u5185\u90e8\u5206\u7247\u6570\u91cf\u4ee5\u63d0\u9ad8\u5e76\u53d1\u6027\u80fd"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"WithAsyncCleanup"})," - \u542f\u7528\u5f02\u6b65\u6e05\u7406"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"nodeshardedcache",children:"NodeShardedCache"}),"\n",(0,i.jsx)(n.p,{children:"\u57fa\u4e8e\u4e00\u81f4\u6027\u54c8\u5e0c\u7684\u5206\u7247\u7f13\u5b58\uff0c\u5c06\u952e\u6620\u5c04\u5230\u4e0d\u540c\u7684\u7f13\u5b58\u8282\u70b9\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'shardedCache := cache.NewNodeShardedCache(\r\n    cache.WithNodeHashReplicas(100),  // \u6bcf\u4e2a\u7269\u7406\u8282\u70b9\u7684\u865a\u62df\u8282\u70b9\u6570\r\n    cache.WithNodeReplicaFactor(2),   // \u6570\u636e\u526f\u672c\u6570\u91cf (\u5bb9\u9519)\r\n)\r\n\r\n// \u6dfb\u52a0\u8282\u70b9\r\nshardedCache.AddNode("node1", node1Cache, 1)  // \u6743\u91cd\u4e3a1\r\nshardedCache.AddNode("node2", node2Cache, 2)  // \u6743\u91cd\u4e3a2\n'})}),"\n",(0,i.jsx)(n.h3,{id:"clustercache",children:"ClusterCache"}),"\n",(0,i.jsx)(n.p,{children:"\u7ed3\u5408\u96c6\u7fa4\u7ba1\u7406\u548c\u5206\u7247\u529f\u80fd\u7684\u7f13\u5b58\u5b9e\u73b0\uff0c\u7528\u4e8e\u52a8\u6001\u96c6\u7fa4\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'clusterCache, err := cluster.NewClusterCache(\r\n    localCache, \r\n    "node-1", \r\n    ":7946",\r\n    cluster.WithGossipInterval(500 * time.Millisecond),\r\n)\r\n\r\n// \u52a0\u5165\u96c6\u7fa4\r\nclusterCache.Join("192.168.1.100:7946")\n'})}),"\n",(0,i.jsx)(n.h3,{id:"remotecache",children:"RemoteCache"}),"\n",(0,i.jsx)(n.p,{children:"\u8fde\u63a5\u5230\u8fdc\u7a0b\u7f13\u5b58\u8282\u70b9\u7684\u5ba2\u6237\u7aef\u5b9e\u73b0\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'remoteCache := distributed.NewRemoteCache(\r\n    "remote-node-1", \r\n    "cache.example.com:8080",\r\n    distributed.WithTimeout(500 * time.Millisecond),\r\n    distributed.WithRetry(3, 100 * time.Millisecond),\r\n)\n'})}),"\n",(0,i.jsx)(n.h2,{id:"\u7f13\u5b58\u4e00\u81f4\u6027\u7b56\u7565",children:"\u7f13\u5b58\u4e00\u81f4\u6027\u7b56\u7565"}),"\n",(0,i.jsx)(n.p,{children:"FyerCache \u63d0\u4f9b\u4e86\u4e0d\u540c\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u7b56\u7565\u5b9e\u73b0\uff0c\u7528\u4e8e\u534f\u8c03\u7f13\u5b58\u548c\u540e\u7aef\u5b58\u50a8\u4e4b\u95f4\u7684\u6570\u636e\u4e00\u81f4\u6027\uff1a"}),"\n",(0,i.jsx)(n.h3,{id:"cacheasidestrategy",children:"CacheAsideStrategy"}),"\n",(0,i.jsx)(n.p,{children:'"\u65c1\u8def\u7f13\u5b58"\u7b56\u7565\u5b9e\u73b0\u3002\u9996\u5148\u67e5\u8be2\u7f13\u5b58\uff0c\u7f13\u5b58\u672a\u547d\u4e2d\u65f6\u4ece\u6570\u636e\u6e90\u8bfb\u53d6\u3002'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"strategy := consistency.NewCacheAsideStrategy(\r\n    cacheImpl, \r\n    dataSource,\r\n    consistency.WithCacheAsideTTL(10 * time.Minute),\r\n    consistency.WithCacheAsideWriteOnMiss(true),\r\n)\r\n\r\n// \u4f7f\u7528\u7b56\u7565\r\nvalue, err := strategy.Get(ctx, key)\r\n\r\n// \u8bbe\u7f6e\u503c\r\nerr = strategy.Set(ctx, key, value, expiration)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"writethroughstrategy",children:"WriteThroughStrategy"}),"\n",(0,i.jsx)(n.p,{children:'"\u76f4\u5199"\u7b56\u7565\u5b9e\u73b0\u3002\u5199\u64cd\u4f5c\u540c\u65f6\u66f4\u65b0\u7f13\u5b58\u548c\u6570\u636e\u6e90\u3002'}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:"strategy := consistency.NewWriteThroughStrategy(\r\n    cacheImpl, \r\n    dataSource,\r\n    consistency.WithWriteThroughTTL(10 * time.Minute),\r\n    consistency.WithDelayedWrite(true, 100 * time.Millisecond),\r\n)\n"})}),"\n",(0,i.jsx)(n.h3,{id:"mqnotifierstrategy",children:"MQNotifierStrategy"}),"\n",(0,i.jsx)(n.p,{children:"\u57fa\u4e8e\u6d88\u606f\u961f\u5217\u7684\u7f13\u5b58\u4e00\u81f4\u6027\u7b56\u7565\u3002\u6570\u636e\u6e90\u53d8\u66f4\u65f6\u901a\u8fc7\u6d88\u606f\u961f\u5217\u901a\u77e5\u7f13\u5b58\u5931\u6548\u3002"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-go",children:'strategy := consistency.NewMQNotifierStrategy(\r\n    cacheImpl, \r\n    dataSource,\r\n    mqPublisher,\r\n    consistency.WithMQTopic("cache:invalidation"),\r\n    consistency.WithMQNotifierTTL(10 * time.Minute),\r\n)\n'})})]})}function o(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(a,{...e})}):a(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>d});var c=r(6540);const i={},s=c.createContext(i);function t(e){const n=c.useContext(s);return c.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),c.createElement(s.Provider,{value:n},e.children)}}}]);